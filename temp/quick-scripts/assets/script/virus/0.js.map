{"version":3,"sources":["0.js"],"names":["cc","Class","extends","Component","properties","m_labHp","Label","m_Back","Node","m_Body","ctor","m_bHurt","m_bDie","m_bSleep","m_Speed","v2","m_LastSpeedPro","m_DieGold","onLoad","runAction","repeatForever","rotateBy","setHp","init","active","node","setScale","randomSpeed","setMoveStart","start","hit","m_HP","gVirusMake","key","colorObjcet","hasOwnProperty","parseInt","runColorAction","seq","sequence","scaleTo","callFunc","createDieAnim","bind","delayTime","onVirusKilled","hurt","stopAllActions","i","children","length","scaleBy","onCollisionEnter","other","self","tag","setColor","color","colorObject","m_CurColor","setVirusColor","scale","setSpeed","speed","setDieGold","gold","time","js","getComponent","colorAction","stopAction","tintTo","r","g","b","num","string","m_BaseHp","y","x","random","dt","sleep","pro"],"mappings":"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","file":"0.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\virus","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        m_labHp:cc.Label,\r\n        m_Back:[cc.Node],\r\n        m_Body:cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    ctor:function(){\r\n        this.m_bHurt = false;\r\n        this.m_bDie = false;\r\n        this.m_bSleep = false;\r\n        this.m_Speed = cc.v2(0,0);\r\n        this.m_LastSpeedPro = 0;\r\n        this.m_DieGold = 0;\r\n    },\r\n    onLoad () {\r\n        this.m_Back[0].runAction(cc.repeatForever(cc.rotateBy(8,360)));\r\n        this.m_Back[1].runAction(cc.repeatForever(cc.rotateBy(8,-360)));\r\n        this.setHp(100);\r\n        // this.setColor(new cc.Color(181,130,255));\r\n        this.init();\r\n        \r\n    },\r\n    init(){\r\n        this.m_Body.active = true;\r\n        this.node.setScale(cc.v2(1,1));\r\n        this.m_Body.setScale(cc.v2(1,1));\r\n        this.m_bDie = false;\r\n        this.randomSpeed();\r\n        this.setMoveStart();\r\n        // this.randomColor();\r\n        // this.runRandomColorAction(0.5,this.node);\r\n    },\r\n    start () {\r\n\r\n    },\r\n    hit:function(){\r\n        if(this.m_bDie)return;\r\n        this.m_HP -= 1;\r\n        this.setHp(this.m_HP);\r\n        gVirusMake.hit(-1);\r\n        for (const key in this.colorObjcet) {\r\n            if (this.colorObjcet.hasOwnProperty(key)) {\r\n                if( this.m_HP <= parseInt(key)){\r\n                    this.runColorAction(0.2,this.node,this.colorObjcet[key]);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        \r\n        if( this.m_HP <= 0 ){\r\n            this.m_bDie = true;\r\n            var seq = cc.sequence(\r\n                cc.scaleTo(0.05,0,0),\r\n                cc.callFunc(function(){\r\n                    gVirusMake.createDieAnim(this.node);\r\n                }.bind(this)),\r\n                cc.delayTime(1),\r\n                cc.callFunc(function(){\r\n                    gVirusMake.onVirusKilled(this.node);\r\n                }.bind(this)),\r\n            );\r\n            this.m_Body.runAction(seq);\r\n\r\n        }else{\r\n            this.hurt();\r\n        }\r\n    },\r\n    stopAllActions:function(node){\r\n        if( node == null )node = this.node;\r\n        for (var i = 0; i < node.children.length; i++) {\r\n            node.children[i].stopAllActions();\r\n            this.stopAllActions(node.children[i]);\r\n        }\r\n        this.node.stopAllActions();\r\n    },\r\n    hurt:function(){\r\n        if( !this.m_bHurt){\r\n            this.m_bHurt = true;\r\n            var seq = cc.sequence(\r\n                cc.scaleBy(0.08,1.1,1.1),\r\n                cc.scaleBy(0.1,0.9,0.9),\r\n                cc.callFunc(function(){\r\n                    this.m_bHurt = false;\r\n                }.bind(this)),\r\n            );\r\n            this.node.runAction(seq);\r\n        }\r\n    },\r\n    setMoveStart:function(){\r\n\r\n    },\r\n    onCollisionEnter: function (other,self) {\r\n\r\n        if( other.tag == 100 || other.tag == 99 ||  other.tag == 98 ){\r\n            this.hit();\r\n        }\r\n    },\r\n    setColor(color,colorObject){\r\n        this.colorObjcet = colorObject;\r\n        this.m_CurColor = color;\r\n        this.node.color = color;\r\n        setVirusColor(this.node,color);\r\n    },\r\n    setScale:function(scale){\r\n        this.node.setScale(cc.v2(scale,scale));\r\n    },\r\n    setSpeed:function(speed){\r\n        this.m_Speed = speed;\r\n    },\r\n    //死亡掉落金币\r\n    setDieGold:function(gold){\r\n        this.m_DieGold = gold;\r\n    },\r\n    runColorAction:function(time,node,color){\r\n        this.m_CurColor = color;\r\n        for (var i = 0; i < node.children.length; i++) {\r\n            var js = node.children[i].getComponent('color');\r\n            if(js != null){\r\n\r\n                if(node.children[i].colorAction != null){\r\n                    node.children[i].stopAction(node.children[i].colorAction);\r\n                }\r\n                var colorAction = cc.tintTo(time,color.r,color.g,color.b);\r\n                node.children[i].colorAction = colorAction;\r\n                node.children[i].runAction(colorAction);\r\n            }\r\n            this.runColorAction(time,node.children[i],color);\r\n        }\r\n\r\n    },\r\n    // randomColor(){\r\n    //     this.setColor(this.getRandomColor());\r\n    // },\r\n    // getRandomColor(){\r\n    //     var arr = new Array(3);\r\n    //     arr[0] = random(127,255);\r\n    //     arr[1] = 127;\r\n    //     arr[2] = 255;\r\n    //     var rgb = new Array();\r\n    //     for (var i = 0; i < 2; i++) {\r\n    //         var index = random(0,arr.length);\r\n    //         rgb.push(arr[index]);\r\n    //         arr.splice(index,1);\r\n    //     }\r\n    //     rgb.push(arr[0]);\r\n    //     return new cc.Color(rgb[0],rgb[1],rgb[2]);\r\n    // },\r\n    setHp:function(num){\r\n        this.m_HP = num;\r\n        this.m_labHp.string = num;\r\n        this.m_BaseHp = num;\r\n    },\r\n    setMoveStart:function(){\r\n        this.node.y = 1780;\r\n        this.node.x = random(160,740);\r\n    },\r\n    randomSpeed:function(){\r\n        if(this.m_bSleep)return;\r\n        this.m_Speed.x = random(80,150);\r\n        this.m_Speed.y = random(80,150);\r\n        if( random(0,100) > 50 ){\r\n            this.m_Speed.x *= -1;\r\n        }\r\n    },\r\n    update (dt) {\r\n        if(this.m_bDie || this.m_bSleep)return;\r\n        if( this.node.y < -150){\r\n            this.setMoveStart();\r\n            this.randomSpeed();\r\n        }\r\n        this.node.y -= this.m_Speed.y*dt;\r\n        if( (this.m_Speed.x> 0 && this.node.x > 840)|| (this.m_Speed.x< 0 && this.node.x < 60) ){\r\n            this.m_Speed.x*=-1;\r\n        }\r\n        this.node.x += this.m_Speed.x*dt;\r\n\r\n    },\r\n    sleep:function(sleep,pro){\r\n        this.m_bSleep = sleep;\r\n    },\r\n});\r\n"]}