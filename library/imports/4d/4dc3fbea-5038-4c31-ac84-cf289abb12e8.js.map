{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\GameControl.js"],"names":["cc","Class","extends","Component","properties","m_Logo","Node","m_LevelDesign","m_Top","m_Setting","m_ClickGet","m_Bottom","m_Tip","m_BG","m_AirPlane","m_MonsterHP","m_GoldPrefab","Prefab","m_TouchControl","m_BulletPrefab","m_VirusMake","m_BulletParent","m_BlackBG","m_Resurgence","m_AirPlaneDieAnim","Animation","m_SubWeaponParent","ctor","m_ClassArray","Array","goldPool","NodePool","bulletPool","onLoad","gDataCtl","clear","director","getCollisionManager","enabled","gGameCtl","getComponent","push","Reset","gAirPlane","i","length","cls","Play","scheduleOnce","active","bind","playOver","node","createGoldAnim","srcPos","dstPos","srcNode","radius","goldCount","addGold","callBack","array","getPoint","x","y","nodeArray","gold","createGold","randPos","v2","random","setPosition","sort","a","b","disa","distance","disb","notPlay","targetGoldNode","pos","id","seq","sequence","moveTo","delayTime","callFunc","scaleTo","runAction","onGoldKilled","parentNode","enemy","size","get","instantiate","parent","createBullet","count","bullet","CollType","COLLISION_BULLET","getPosition","js","init","setSecondPos","left","right","imgSize","offset","onBulletKilled","item","show","put","onBulletKilledAll","children","sleepBullet","speed","setSpeed","moveAirPlane","cur_pos","r","ox","oy","point","radians","Math","PI","round","sin","cos","unshift","start","Action","action","ACTION_RESET","ActionReset","ACTION_PLAY","ActionPlay","ACTION_MOVE_OUT","ActionMoveOut","ACTION_MOVE_IN","ActionMoveIn","MoveOut","MoveIn","Test1","target","data","updateData","ActiveReset","ActivePlay","NextLevel","ActiveMoveOut","ActiveMoveIn","blackBGAnim","fadeTo","playAirPlaneDieAnim","play","GameReset","gTouchCtl","gBottom","onUpdate"],"mappings":"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","file":"GameControl.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        m_Logo:cc.Node,\r\n        m_LevelDesign:cc.Node,\r\n        m_Top:cc.Node,\r\n        m_Setting:cc.Node,\r\n        m_ClickGet:cc.Node,\r\n        m_Bottom:cc.Node,\r\n        m_Tip:cc.Node,\r\n        m_BG:cc.Node,\r\n        m_AirPlane:cc.Node,\r\n        m_MonsterHP:cc.Node,\r\n        m_GoldPrefab:cc.Prefab,\r\n        m_TouchControl:cc.Node,\r\n        m_BulletPrefab:cc.Prefab,\r\n        m_VirusMake:cc.Node,\r\n        m_BulletParent:cc.Node,\r\n        m_BlackBG:cc.Node,\r\n        m_Resurgence:cc.Node,\r\n        m_AirPlaneDieAnim:cc.Animation,\r\n        m_SubWeaponParent:cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    ctor:function(){\r\n        this.m_ClassArray = new Array();\r\n        this.goldPool = new cc.NodePool();\r\n        this.bulletPool = new cc.NodePool();\r\n    },\r\n    onLoad () {\r\n\r\n        gDataCtl.clear();\r\n        cc.director.getCollisionManager().enabled = true;\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;\r\n\r\n        gGameCtl = this;\r\n        this.m_Logo = this.m_Logo.getComponent('Logo');\r\n        this.m_ClassArray.push(this.m_Logo);\r\n\r\n        this.m_LevelDesign = this.m_LevelDesign.getComponent('LevelDesign');\r\n        this.m_LevelDesign.Reset();\r\n        this.m_ClassArray.push(this.m_LevelDesign);\r\n\r\n        this.m_Top = this.m_Top.getComponent('Top');\r\n        this.m_ClassArray.push(this.m_Top);\r\n\r\n        this.m_Setting = this.m_Setting.getComponent('Setting');\r\n        this.m_ClassArray.push(this.m_Setting);\r\n\r\n        this.m_ClickGet = this.m_ClickGet.getComponent('ClickGet');\r\n        this.m_ClassArray.push(this.m_ClickGet);\r\n\r\n\r\n        this.m_Bottom = this.m_Bottom.getComponent('Bottom');\r\n        this.m_ClassArray.push(this.m_Bottom);\r\n\r\n        this.m_Tip = this.m_Tip.getComponent('Tip');\r\n        this.m_ClassArray.push(this.m_Tip);\r\n\r\n        this.m_BG = this.m_BG.getComponent('BG');\r\n        this.m_ClassArray.push(this.m_BG);\r\n\r\n        this.m_AirPlane = this.m_AirPlane.getComponent('AirAutoPlay');\r\n        this.m_ClassArray.push(this.m_AirPlane);\r\n\r\n        this.m_MonsterHP = this.m_MonsterHP.getComponent('MonsterHp');\r\n        this.m_ClassArray.push(this.m_MonsterHP);\r\n\r\n        this.m_VirusMake = this.m_VirusMake.getComponent('VirusMake');\r\n        this.m_ClassArray.push(this.m_VirusMake);\r\n\r\n        \r\n        this.m_Resurgence = this.m_Resurgence.getComponent('Resurgence');\r\n\r\n        gAirPlane = this.m_AirPlane;\r\n\r\n        for (var i = 0; i < this.m_ClassArray.length; i++) {\r\n            var cls = this.m_ClassArray[i];\r\n            if( cls.Play != null ){\r\n                cls.Play();\r\n            }\r\n        }\r\n        \r\n\r\n        this.scheduleOnce(function(){\r\n            this.m_TouchControl.active = true;\r\n        }.bind(this),1.5);\r\n\r\n\r\n        this.m_AirPlaneDieAnim.playOver=function(){\r\n            this.m_AirPlaneDieAnim.node.active = false;\r\n        }.bind(this)\r\n\r\n    },\r\n    //全局调用\r\n    //srcPos:开始位置,\r\n    //dstPos:目标位置\r\n    //radius:圆半径\r\n    //goldCount:切分多少块,多少个金币\r\n    //addGold:需要增加多少金币\r\n    //callBack:动画结束回调\r\n    createGoldAnim:function(srcPos,dstPos,srcNode,radius,goldCount,addGold,callBack){\r\n        \r\n        var array = this.getPoint(radius,srcPos.x,srcPos.y,goldCount);\r\n\r\n        var nodeArray = new Array();\r\n        for (var i = 0; i < array.length; i++) {\r\n            var gold = this.createGold(this.node);\r\n            var randPos = cc.v2(array[i].x+random(0,50),array[i].y+random(0,50));\r\n            gold.setPosition(srcPos);\r\n            nodeArray.push({gold,randPos});\r\n        }\r\n        nodeArray.sort(function(a,b){\r\n            var disa = distance(a.randPos,dstPos);\r\n            var disb = distance(b.randPos,dstPos);\r\n            return disa - disb;\r\n        });\r\n        var notPlay = false;\r\n        var targetGoldNode = srcNode;\r\n        for (var i = 0; i < nodeArray.length; i++) {\r\n\r\n            var pos = nodeArray[i].randPos;\r\n            var node = nodeArray[i].gold;\r\n            nodeArray[i].gold.id = i;\r\n            var seq = cc.sequence(\r\n                cc.moveTo(0.5,pos),\r\n                cc.delayTime(i*0.03),\r\n                cc.moveTo(0.5,dstPos),\r\n                cc.callFunc(function(node){\r\n                    // targetGoldNode.stopAllActions();\r\n                    if( !notPlay){\r\n                        notPlay = true;\r\n                        var seq = cc.sequence(\r\n                            cc.scaleTo(0.1,2,2),\r\n                            cc.scaleTo(0.1,1,1),\r\n                            cc.callFunc(function(){\r\n                                notPlay = false;\r\n                            }),\r\n                        );\r\n                        targetGoldNode.runAction(seq);\r\n                    }\r\n                    \r\n                    if(node.id == nodeArray.length-1){\r\n                        if( callBack != null )callBack(addGold);\r\n                    }\r\n                    this.onGoldKilled(node);\r\n                }.bind(this))\r\n            );\r\n\r\n            node.runAction(seq);\r\n        }\r\n    },\r\n    createGold: function (parentNode) {\r\n        let enemy = null;\r\n        if (this.goldPool.size() > 0) { // 通过 size 接口判断对象池中是否有空闲的对象\r\n            enemy = this.goldPool.get();\r\n        } else { // 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建\r\n            enemy = cc.instantiate(this.m_GoldPrefab);\r\n        }\r\n        enemy.parent = parentNode; // 将生成的敌人加入节点树\r\n        return enemy;\r\n    },\r\n    createBullet:function(count){\r\n        if( count == 1){\r\n            let bullet = null;\r\n            if (this.bulletPool.size() > 0) { // 通过 size 接口判断对象池中是否有空闲的对象\r\n                bullet = this.bulletPool.get();\r\n            } else { // 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建\r\n                bullet = cc.instantiate(this.m_BulletPrefab);\r\n                bullet.CollType = COLLISION_BULLET;\r\n            }\r\n            bullet.parent = this.m_BulletParent; // 将生成的敌人加入节点树\r\n\r\n            var pos = this.m_AirPlane.node.getPosition();\r\n            pos.y += 116;\r\n            bullet.setPosition(pos);\r\n            pos.y += 100;\r\n            var js = bullet.getComponent('Bullet');\r\n            js.init();\r\n            js.setSecondPos(pos);\r\n        }else{\r\n            var left=1;\r\n            var right=1;\r\n            var imgSize = 30;\r\n            for (var i = 0; i < count; i++) {\r\n                    \r\n                var offset = 0;\r\n                if( i % 2 ){\r\n                    offset = left*imgSize;\r\n                    offset -= imgSize/2;\r\n                    left++;\r\n                }else{\r\n                    offset = -right*imgSize;\r\n                    offset += imgSize/2;\r\n                    right++;\r\n                }\r\n                let bullet = null;\r\n                if (this.bulletPool.size() > 0) { // 通过 size 接口判断对象池中是否有空闲的对象\r\n                    bullet = this.bulletPool.get();\r\n                } else { // 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建\r\n                    bullet = cc.instantiate(this.m_BulletPrefab);\r\n                    bullet.CollType = COLLISION_BULLET;\r\n                }\r\n                bullet.parent = this.m_BulletParent; // 将生成的敌人加入节点树\r\n\r\n                var pos = this.m_AirPlane.node.getPosition();\r\n                pos.y += 116;\r\n                bullet.setPosition(pos);\r\n                var js = bullet.getComponent('Bullet');\r\n                js.init();\r\n                js.setSecondPos(cc.v2(pos.x+offset,pos.y+100));\r\n                \r\n            }\r\n        }\r\n    },\r\n    onBulletKilled:function(bullet){\r\n        for (var item in this.bulletPool) {\r\n            if ( item == bullet ){\r\n                return;\r\n            }\r\n        }\r\n        \r\n        bullet.runAction(cc.show());\r\n        bullet.parent = null;\r\n        this.bulletPool.put(bullet); // 和初始化时的方法一样，将节点放进对象池，这个方法会同时调用节点的 removeFromParent\r\n    },\r\n    onBulletKilledAll:function(){\r\n        var children = this.m_BulletParent.children;\r\n\r\n        for (var i = 0; i != children.length; ) {\r\n            if( this.onBulletKilled != null){\r\n                this.onBulletKilled(children[i]);\r\n            }\r\n        }\r\n    },\r\n    sleepBullet:function(speed){\r\n        var children = this.m_BulletParent.children;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var js = children[i].getComponent('Bullet');\r\n            if( js != null ){\r\n                js.setSpeed(speed);\r\n            }\r\n        }\r\n    },\r\n    onGoldKilled: function (gold) {\r\n        // enemy 应该是一个 cc.Node\r\n        this.goldPool.put(gold); // 和初始化时的方法一样，将节点放进对象池，这个方法会同时调用节点的 removeFromParent\r\n    },\r\n\r\n    moveAirPlane:function(pos){\r\n        var cur_pos = this.m_AirPlane.node.getPosition();\r\n        this.m_AirPlane.node.setPosition(cc.v2(cur_pos.x+pos.x,cur_pos.y+pos.y));\r\n    },\r\n    /*\r\n    * 求圆周上等分点的坐标\r\n    * ox,oy为圆心坐标\r\n    * r为半径\r\n    * count为等分个数\r\n    */\r\n    getPoint:function(r, ox, oy, count){\r\n        var point = []; //结果\r\n        var radians = (Math.PI / 180) * Math.round(360 / count), //弧度\r\n            i = 0;\r\n        for(; i < count; i++){\r\n            var x = ox + r * Math.sin(radians * i),\r\n                y = oy + r * Math.cos(radians * i);\r\n    \r\n            point.unshift({x:x,y:y}); //为保持数据顺时针\r\n        }\r\n        return point;\r\n    },\r\n    start () {\r\n\r\n    },\r\n\r\n    Action:function(action){\r\n        \r\n        if( action == ACTION_RESET){\r\n            this.ActionReset();\r\n        }else if( action == ACTION_PLAY){\r\n            this.ActionPlay();\r\n        }else if(action == ACTION_MOVE_OUT){\r\n            this.ActionMoveOut();\r\n        }else if(action == ACTION_MOVE_IN){\r\n            this.ActionMoveIn();\r\n        }\r\n    },\r\n\r\n    ActionReset:function(){\r\n\r\n        for (var i = 0; i < this.m_ClassArray.length; i++) {\r\n            var cls = this.m_ClassArray[i];\r\n            if( cls.Reset != null ){\r\n                cls.Reset();\r\n            }\r\n        }\r\n    },\r\n    ActionPlay:function(){\r\n        for (var i = 0; i < this.m_ClassArray.length; i++) {\r\n            var cls = this.m_ClassArray[i];\r\n            if( cls.Play != null ){\r\n                cls.Play();\r\n            }\r\n        }\r\n    },\r\n    ActionMoveOut:function(){\r\n        for (var i = 0; i < this.m_ClassArray.length; i++) {\r\n            var cls = this.m_ClassArray[i];\r\n            if( cls.MoveOut != null ){\r\n                cls.MoveOut();\r\n            }\r\n        }\r\n    },\r\n    ActionMoveIn:function(){\r\n        for (var i = 0; i < this.m_ClassArray.length; i++) {\r\n            var cls = this.m_ClassArray[i];\r\n            if( cls.MoveIn != null ){\r\n                cls.MoveIn();\r\n            }\r\n        }\r\n    },\r\n    \r\n    Test1:function(target,data){\r\n        if( data == '重置'){\r\n            // gDataCtl.AddGold(999);\r\n            gDataCtl.clear();\r\n            this.m_Top.updateData();\r\n            this.m_ClickGet.updateData();\r\n            this.ActiveReset();\r\n\r\n        }else if( data == '播放'){\r\n            this.ActivePlay();\r\n            this.m_LevelDesign.NextLevel();\r\n        }else if(data == '移出'){\r\n            this.ActiveMoveOut();\r\n        }else if(data == '移入'){\r\n            this.ActiveMoveIn();\r\n        }\r\n    },\r\n    blackBGAnim:function(show){\r\n        if( show ){\r\n            this.m_BlackBG.runAction(cc.fadeTo(0.5,130));\r\n        }else{\r\n            this.m_BlackBG.runAction(cc.fadeTo(0.5,0));\r\n        }\r\n    },\r\n    playAirPlaneDieAnim:function(pos){\r\n        this.m_AirPlaneDieAnim.node.active = true;\r\n        this.m_AirPlaneDieAnim.node.setPosition(pos);\r\n        this.m_AirPlaneDieAnim.play('explode');\r\n    },\r\n    GameReset:function(){\r\n        cc.director.getCollisionManager().enabled = true;\r\n        gTouchCtl.Reset();\r\n        gBottom.onUpdate();\r\n    }\r\n    // update (dt) {},\r\n});\r\n"]}